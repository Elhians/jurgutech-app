<div class="page">
    <div class="coop-view">
        <button class="return-button" (click)="goBack()">â¬… Retour</button>
        <h2 class="coop-title">
            {{ coop.name }}
            <span
              class="badge"
              [ngClass]="{ 'running': coop.isRunning, 'stopped': !coop.isRunning }"
            >
              {{ coop.isRunning ? `ğŸŸ¢ En marche` : `ğŸ”´ Ã€ l'arrÃªt` }}
            </span>
        </h2>
          
        <!-- Commandes -->
        <div class="coop-commands">
            <button
              *ngIf="!coop.isRunning"
              mat-raised-button
              class="start"
              (click)="startSystem()"
            >
              ğŸš€ DÃ©marrer le systÃ¨me
            </button>
          
            <button
              *ngIf="coop.isRunning"
              mat-raised-button
              class="stop"
              (click)="stopSystem()"
            >
              â›” Ã‰teindre le systÃ¨me
            </button>
        </div>

        <!-- Cartes capteurs -->
        <div class="sensor-grid">
            <div class="sensor-cards">
                <!-- TempÃ©rature -->
                <mat-card class="sensor-card temperature">
                  <mat-card-title>
                    <span class="icon">ğŸŒ¡ï¸</span> TempÃ©rature
                  </mat-card-title>
                  <mat-card-content>{{ coop.thermometer.temperature }}Â°C</mat-card-content>
                  <mat-card-actions>
                    <button class="return-button" (click)="viewTemperatureDetails()">DÃ©tails</button>
                    <button class="fan-toggle" [ngClass]="{'fan-on': coop.fan.isOn, 'fan-off': !coop.fan.isOn}" (click)="toggleVent()">
                      <span class="fan-icon">{{ coop.fan.isOn ? 'ğŸ’¨' : 'ğŸ’¨' }}</span>
                      {{ coop.fan.isOn ? 'ON' : 'OFF' }}
                    </button>
                  </mat-card-actions>
                </mat-card>
            
                <!-- HumiditÃ© -->
                <mat-card class="sensor-card humidity">
                  <mat-card-title>
                    <span class="icon">ğŸ’§</span> HumiditÃ©
                  </mat-card-title>
                  <mat-card-content>{{ coop.humiditySensor.humidity }}%</mat-card-content>
                  <mat-card-actions>
                    <button class="return-button" (click)="viewHumidityDetails()">DÃ©tails</button>
                    <button class="fan-toggle" [ngClass]="{'fan-on': coop.fan.isOn, 'fan-off': !coop.fan.isOn}" (click)="toggleVent()">
                      <span class="fan-icon">{{ coop.fan.isOn ? 'ğŸ’¨' : 'ğŸ’¨' }}</span>
                      {{ coop.fan.isOn ? 'ON' : 'OFF' }}
                    </button>
                  </mat-card-actions>
                </mat-card>
            
                <!-- Niveau d'eau -->
                <mat-card class="sensor-card water">
                  <mat-card-title>
                    <span class="icon">ğŸš°</span> Niveau d'eau
                  </mat-card-title>
                  <mat-card-content>{{ coop.waterTrough.level }}%</mat-card-content>
                  <mat-card-actions>
                    <button class="return-button" (click)="viewWaterDetails()">DÃ©tails</button>
                    <button class="return-button" (click)="refillWater()">Remplir</button>
                  </mat-card-actions>
                </mat-card>
            
                <!-- Nourriture -->
                <mat-card class="sensor-card food">
                  <mat-card-title>
                    <span class="icon">ğŸ—</span> Nourriture
                  </mat-card-title>
                  <mat-card-content>{{ coop.feeder.level }}%</mat-card-content>
                  <mat-card-actions>
                    <button class="return-button" (click)="viewFoodDetails()">DÃ©tails</button>
                    <button class="return-button" (click)="refillFood()">Remplir</button>
                  </mat-card-actions>
                </mat-card>
            
                <!-- Nettoyage - Conditionnellement affichÃ© -->
                <mat-card class="sensor-card clean" *ngIf="coop.haveCleanSys">
                  <mat-card-title>
                    <span class="icon">ğŸ§¹</span> Dernier nettoyage
                  </mat-card-title>
                  <mat-card-content>{{ coop.cleaningSystem?.lastCleaned?.toDate() | date:'short' }}</mat-card-content>
                  <mat-card-actions>
                    <button class="return-button" (click)="cleanCoop()">Nettoyer</button>
                  </mat-card-actions>
                </mat-card>

                <!-- Batterie - Conditionnellement affichÃ©e -->
                <mat-card class="sensor-card battery" *ngIf="coop.haveBattery">
                  <mat-card-title>
                    <span class="icon">ğŸ”‹</span> Batterie
                  </mat-card-title>
                  <mat-card-content>{{ coop.battery?.level }}%</mat-card-content>
                  <mat-card-actions>
                    <button class="return-button" (click)="viewBatteryDetails()">DÃ©tails</button>
                  </mat-card-actions>
                </mat-card>

                <!-- Ammoniac -->
                <mat-card class="sensor-card gas">
                  <mat-card-title>
                    <span class="icon">ğŸ§ª</span> Ammoniac
                  </mat-card-title>
                  <mat-card-content>{{ coop.ammoniaSensor.ammonia }}ppm</mat-card-content>
                  
                  <mat-card-actions>
                    <button class="return-button" (click)="viewAmmoniaDetails()">DÃ©tails</button>
                    <button class="fan-toggle" [ngClass]="{'fan-on': coop.fan.isOn, 'fan-off': !coop.fan.isOn}" (click)="toggleVent()">
                      <span class="fan-icon">{{ coop.fan.isOn ? 'ğŸ’¨' : 'ğŸ’¨' }}</span>
                      {{ coop.fan.isOn ? 'ON' : 'OFF' }}
                    </button>
                  </mat-card-actions>
                </mat-card>
              </div>
        </div>

        <!-- CamÃ©ras -->
        <div class="cameras-section" *ngIf="cameras.length > 0">
          <h3 class="section-title">CamÃ©ras</h3>
          <div class="cameras-grid">
            <div class="camera-card" *ngFor="let camera of cameras" (click)="openCamera(camera)">
              <div class="camera-preview">
                <span class="camera-icon">ğŸ“¹</span>
                <span class="camera-location">{{ camera.location }}</span>
              </div>
              <button class="view-button">Voir le flux</button>
            </div>
          </div>
        </div>
    </div>
</div>


