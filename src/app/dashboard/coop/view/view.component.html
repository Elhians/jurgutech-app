<div class="page">
    <div class="coop-view">
        <button class="return-button" (click)="goBack()">â¬… Retour</button>
        <h2 class="coop-title">
            {{ coop?.name }}
            <span
              class="badge"
              [ngClass]="{ 'running': coop?.isRunning, 'stopped': !coop?.isRunning }"
            >
              {{ coop?.isRunning ? 'ğŸŸ¢ En marche' : 'ğŸ”´ Ã€ lâ€™arrÃªt' }}
            </span>
        </h2>
          
      
        <!-- Commandes -->
        <div class="coop-commands">
            <button
              *ngIf="!coop?.isRunning"
              mat-raised-button
              class="start"
              (click)="startSystem()"
            >
              ğŸš€ DÃ©marrer le systÃ¨me
            </button>
          
            <button
              *ngIf="coop?.isRunning"
              mat-raised-button
              class="stop"
              (click)="stopSystem()"
            >
              â›” Ã‰teindre le systÃ¨me
            </button>
          </div>
          
      
        <!-- Cartes capteurs -->
        <div class="sensor-grid">
            <div class="sensor-cards">
                <!-- TempÃ©rature -->
                <mat-card class="sensor-card temperature">
                  <mat-card-title>
                    <span class="icon">ğŸŒ¡ï¸</span> TempÃ©rature
                  </mat-card-title>
                  <mat-card-content>{{ coopData?.temperature }} 27Â°C</mat-card-content>
                  <mat-card-actions>
                    <button class="return-button" (click)="viewTemperatureDetails()">DÃ©tails</button>
                    <button class="return-button" (click)="changeTemperature()">Changer</button>
                  </mat-card-actions>
                </mat-card>
            
                <!-- HumiditÃ© -->
                <mat-card class="sensor-card humidity">
                  <mat-card-title>
                    <span class="icon">ğŸ’§</span> HumiditÃ©
                  </mat-card-title>
                  <mat-card-content>{{ coopData?.humidity }} 15 %</mat-card-content>
                  <mat-card-actions>
                    <button class="return-button" (click)="viewHumidityDetails()">DÃ©tails</button>
                    <button class="return-button" (click)="toggleVent()">Ventilo {{ coop?.isRunning ? 'OFF' : 'ON' }}</button>
                  </mat-card-actions>
                </mat-card>
            
                <!-- Niveau d'eau -->
                <mat-card class="sensor-card water">
                  <mat-card-title>
                    <span class="icon">ğŸš°</span> Niveau d'eau
                  </mat-card-title>
                  <mat-card-content>{{ coopData?.waterLevel }} 30%</mat-card-content>
                  <mat-card-actions>
                    <button class="return-button" (click)="viewWaterDetails()">DÃ©tails</button>
                    <button class="return-button" (click)="refillWater()">Remplir</button>
                  </mat-card-actions>
                </mat-card>
            
                <!-- Nourriture -->
                <mat-card class="sensor-card food">
                  <mat-card-title>
                    <span class="icon">ğŸ—</span> Nourriture
                  </mat-card-title>
                  <mat-card-content>{{ coopData?.foodLevel }} 40%</mat-card-content>
                  <mat-card-actions>
                    <button class="return-button" (click)="viewFoodDetails()">DÃ©tails</button>
                    <button class="return-button" (click)="refillFood()">Remplir</button>
                  </mat-card-actions>
                </mat-card>
            
                <!-- Nettoyage -->
                <mat-card class="sensor-card clean">
                  <mat-card-title>
                    <span class="icon">ğŸ§¹</span> Dernier nettoyage
                  </mat-card-title>
                  <mat-card-content>{{ coopData?.lastCleaned?.toDate() | date:'short' }} 12/02/2025</mat-card-content>
                  <mat-card-actions>
                    <button class="return-button" (click)="viewCleanDetails()">DÃ©tails</button>
                    <button class="return-button" (click)="cleanCoop()">Nettoyer</button>
                  </mat-card-actions>
                </mat-card>

                <!-- Ammoniac -->
                <mat-card class="sensor-card gas">
                  <mat-card-title>
                    <span class="icon">ğŸ§ª</span> Ammoniac
                  </mat-card-title>
                  <mat-card-content>{{ coopData?.ammonia }}15ppm</mat-card-content>
                  <mat-card-actions>
                    <button class="return-button" (click)="viewAmmoniaDetails()">DÃ©tails</button>
                  </mat-card-actions>
                </mat-card>
              </div>
      </div>

      <!-- Real-time Video Sections -->
      <div class="video-grid">
          <div class="video-section" *ngFor="let camera of cameras; let i = index">
              <h3>CamÃ©ra {{ i + 1 }}</h3>
              <button class="return-button" (click)="openVideoModal(camera.streamUrl)">Agrandir</button>
              <video 
                  [src]="camera.streamUrl" 
                  autoplay 
                  muted 
                  controls>
              </video>
          </div>
      </div>
</div>


